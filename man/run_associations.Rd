% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_associations.R
\name{run_associations}
\alias{run_associations}
\title{Run Association Analyses Between Clinical Manifestations (outcome) and a predictor variable (e.g. patient subgroup)}
\usage{
run_associations(
  clinical_data_df,
  clinical_data_cols,
  predictor_var_colname = "subgroup",
  adjust_by = "Age_dx + male.female_dx",
  family = binomial,
  link = "logit",
  plot = FALSE,
  y.axis.text.size = 12,
  or.label.size = 3,
  ntop = 10,
  order = FALSE,
  adjust_p = TRUE,
  p_adj_method = "BH",
  add_xylabs = FALSE,
  name_mapping = NULL,
  x.axis.text.size = 8,
  pt.size = 2,
  filter_sig_OR = TRUE,
  forest_plot_title = "Associations"
)
}
\arguments{
\item{clinical_data_df}{A data frame containing clinical variables (outcomes), the predictor variable,
and optional adjustment covariates.}

\item{clinical_data_cols}{Character or numeric vector specifying the column names or indices
of the clinical manifestations (outcome variables) to test.}

\item{predictor_var_colname}{Character string specifying the name of the predictor variable column
(default: \code{"subgroup"}).}

\item{adjust_by}{Character string defining adjustment variables in formula format (e.g., \code{"Age_dx + male.female_dx"}).
Can include multiple covariates separated by \code{"+"}.}

\item{family}{A family function for the regression (default: \code{binomial}).}

\item{link}{Character string specifying the link function (default: \code{"logit"}).}

\item{plot}{Logical; if \code{TRUE}, generates a forest plot of the top associations (default: \code{FALSE}).}

\item{y.axis.text.size}{Numeric; text size for the y-axis in the forest plot (default: \code{12}).}

\item{or.label.size}{Numeric; text size for the odds ratio labels in the forest plot (default: \code{3}).}

\item{ntop}{Integer; number of top associations to include in the forest plot (default: \code{10}).}

\item{order}{Logical; if \code{TRUE}, orders the output data frame by p-value (default: \code{FALSE}).}

\item{adjust_p}{Logical; whether to perform multiple testing correction (default: \code{TRUE}).}

\item{p_adj_method}{Character; method for p-value adjustment (default: \code{"BH"} for Benjamini–Hochberg).}

\item{add_xylabs}{Logical; whether to add x and y axis labels to the forest plot (default: \code{FALSE}).}

\item{name_mapping}{Optional named vector or data frame for mapping variable names to
human-readable labels in the plot (default: \code{NULL}).}

\item{x.axis.text.size}{Numeric; text size for the x-axis in the forest plot (default: \code{8}).}

\item{pt.size}{Numeric; point size in the forest plot (default: \code{2}).}

\item{filter_sig_OR}{Logical; if \code{TRUE}, filters forest plot to only show significant associations
(based on adjusted p-values) (default: \code{TRUE}).}

\item{forest_plot_title}{Character string; title for the forest plot (default: \code{"Associations"}).}
}
\value{
A named list containing:
\itemize{
\item \code{models} — Nested list of fitted model objects per group and outcome.
\item \code{anova} — Nested list of ANOVA tables for each model.
\item \code{summarized_results} — Combined data frame of model estimates, odds ratios,
confidence intervals, p-values, and (if enabled) adjusted p-values.
\item \code{df} — Input data frame with additional binary indicator columns for each predictor group.
\item \code{forest_plot} — (Optional) ggplot object with a forest plot of top associations.
}
}
\description{
This function performs a series of (generalized) linear regression models to test associations
between one or more clinical manifestations and a categorical predictor variable (e.g., subgroup or cluster),
optionally adjusting for covariates such as age and sex. It supports logistic regression (default)
and returns model objects, ANOVA tables, and a combined summary of odds ratios, confidence intervals,
and p-values. Optionally, it can generate a forest plot of the top associations.
}
\details{
For each clinical manifestation and each level of the predictor variable, the function fits a model of the form:
\deqn{outcome ~ predictor_level + adjustment_covariates}
where \code{predictor_level} is a binary variable indicating membership in a given subgroup.
Odds ratios, 95\% confidence intervals, and p-values are extracted from each model.
P-values can optionally be adjusted for multiple testing using the specified method.
}
\examples{
\dontrun{
results <- run_associations(
  clinical_data_df = lupus_df,
  clinical_data_cols = c("nephritis", "arthritis", "rash"),
  predictor_var_colname = "cluster",
  adjust_by = "Age_dx + sex",
  plot = TRUE,
  ntop = 15
)
}

}
\seealso{
\code{\link[=glm]{glm()}}, \code{\link[=p.adjust]{p.adjust()}}, \code{\link[=make_forest_plot]{make_forest_plot()}}
}
